<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="BloodDonationAppV2.Views.UserHomePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Ana Sayfa"
             BackgroundColor="{StaticResource Gray100}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Sol Panel - Kullanıcı Bilgileri ve Menü -->
        <Frame Grid.Column="0" 
               BackgroundColor="{StaticResource Secondary}"
               CornerRadius="0"
               HasShadow="True"
               Padding="20">
            
            <VerticalStackLayout Spacing="20">
                
                <!-- Kullanıcı Bilgileri -->
                <Frame BackgroundColor="{StaticResource Accent}"
                       CornerRadius="10"
                       Padding="15">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="👤" 
                               FontSize="40"
                               HorizontalOptions="Center" />
                        <Label x:Name="UserNameLabel"
                               Text="Kullanıcı Adı"
                               FontSize="18"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Primary}" />
                        <Label x:Name="UserTcLabel"
                               Text="TC: 12345678901"
                               FontSize="14"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Gray600}" />
                        <Label x:Name="UserBloodGroupLabel"
                               Text="Kan Grubu: A+"
                               FontSize="14"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Primary}"
                               FontAttributes="Bold" />
                        <Label x:Name="UserEmailLabel"
                               Text="email@example.com"
                               FontSize="12"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Gray600}" />
                    </VerticalStackLayout>
                </Frame>

                <!-- Menü Butonları -->
                <VerticalStackLayout Spacing="15">
                    
                    <Button x:Name="CreateDonationRequestBtn"
                            Text="🩸 Bağış Talebinde Bulun"
                            FontSize="14"
                            FontAttributes="Bold"
                            HeightRequest="50"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="{StaticResource Secondary}"
                            Clicked="OnCreateDonationRequestClicked" />

                    <Button x:Name="MyRequestsBtn"
                            Text="📋 Taleplerimi Gör"
                            FontSize="14"
                            FontAttributes="Bold"
                            HeightRequest="50"
                            BackgroundColor="{StaticResource PrimaryLight}"
                            TextColor="{StaticResource Secondary}"
                            Clicked="OnMyRequestsClicked" />

                    <Button x:Name="LogoutBtn"
                            Text="🚪 Çıkış Yap"
                            FontSize="14"
                            FontAttributes="Bold"
                            HeightRequest="50"
                            BackgroundColor="{StaticResource Gray600}"
                            TextColor="{StaticResource Secondary}"
                            Clicked="OnLogoutClicked" />

                </VerticalStackLayout>

            </VerticalStackLayout>
            
        </Frame>

        <!-- Sağ Panel - Bağış İstekleri -->
        <VerticalStackLayout Grid.Column="1" Spacing="20" Padding="20">
            
            <!-- Başlık ve Arama -->
            <Frame BackgroundColor="{StaticResource Secondary}"
                   CornerRadius="10"
                   Padding="20"
                   HasShadow="True">
                
                <VerticalStackLayout Spacing="15">
                    
                    <Label Text="Bağış İstekleri"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}" />

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Entry x:Name="SearchEntry"
                               Grid.Column="0"
                               Placeholder="Konum, kan grubu veya isim ile arayın..."
                               FontSize="14" />

                        <Button x:Name="SearchBtn"
                                Grid.Column="1"
                                Text="🔍 Ara"
                                FontSize="12"
                                BackgroundColor="{StaticResource Info}"
                                TextColor="{StaticResource Secondary}"
                                Margin="10,0,0,0"
                                Clicked="OnSearchClicked" />

                        <Button x:Name="FilterBtn"
                                Grid.Column="2"
                                Text="⚙️ Filtrele"
                                FontSize="12"
                                BackgroundColor="{StaticResource Gray500}"
                                TextColor="{StaticResource Secondary}"
                                Margin="10,0,0,0"
                                Clicked="OnFilterClicked" />

                    </Grid>

                </VerticalStackLayout>
                
            </Frame>

            <!-- Bağış İstekleri Listesi -->
            <ScrollView>
                <CollectionView x:Name="DonationRequestsCollectionView"
                                ItemsSource="{Binding DonationRequests}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="0,5">
                                <Frame BackgroundColor="{StaticResource Secondary}"
                                       CornerRadius="10"
                                       Padding="15"
                                       HasShadow="True">
                                    
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <!-- Hasta Bilgileri -->
                                        <StackLayout Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                                            <Label Text="👤" FontSize="16" VerticalOptions="Center" />
                                            <Label Text="{Binding Ad}" 
                                                   FontSize="16" 
                                                   FontAttributes="Bold" 
                                                   TextColor="{StaticResource Primary}"
                                                   VerticalOptions="Center" />
                                            <Label Text="{Binding Soyad}" 
                                                   FontSize="16" 
                                                   FontAttributes="Bold" 
                                                   TextColor="{StaticResource Primary}"
                                                   VerticalOptions="Center" />
                                        </StackLayout>

                                        <!-- Kan Grubu Badge -->
                                        <Frame Grid.Row="0" Grid.Column="1"
                                               BackgroundColor="{StaticResource Danger}"
                                               CornerRadius="15"
                                               Padding="10,5"
                                               HasShadow="False">
                                            <Label Text="{Binding KanGrubu}"
                                                   FontSize="14"
                                                   FontAttributes="Bold"
                                                   TextColor="{StaticResource Secondary}"
                                                   HorizontalOptions="Center" />
                                        </Frame>

                                        <!-- Konum ve Tarih -->
                                        <StackLayout Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                                            <Label Text="📍" FontSize="14" VerticalOptions="Center" />
                                            <Label Text="{Binding Konum}" 
                                                   FontSize="14" 
                                                   TextColor="{StaticResource Gray600}"
                                                   VerticalOptions="Center" />
                                            <Label Text="📅" FontSize="14" VerticalOptions="Center" Margin="20,0,0,0" />
                                            <Label Text="{Binding TarihSaat, StringFormat='{0:dd/MM/yyyy HH:mm}'}" 
                                                   FontSize="14" 
                                                   TextColor="{StaticResource Gray600}"
                                                   VerticalOptions="Center" />
                                        </StackLayout>

                                        <!-- Açıklama -->
                                        <Label Grid.Row="2" Grid.ColumnSpan="2"
                                               Text="{Binding Aciklama}"
                                               FontSize="14"
                                               TextColor="{StaticResource Tertiary}"
                                               Margin="0,10,0,0" />

                                        <!-- Telefon ve Durum -->
                                        <StackLayout Grid.Row="3" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                                            <Label Text="📞" FontSize="14" VerticalOptions="Center" />
                                            <Label Text="{Binding Telefon}" 
                                                   FontSize="14" 
                                                   TextColor="{StaticResource Info}"
                                                   VerticalOptions="Center" />
                                            
                                            <Frame BackgroundColor="{StaticResource Success}"
                                                   CornerRadius="10"
                                                   Padding="8,3"
                                                   HasShadow="False"
                                                   HorizontalOptions="EndAndExpand">
                                                <Label Text="{Binding Durum}"
                                                       FontSize="12"
                                                       FontAttributes="Bold"
                                                       TextColor="{StaticResource Secondary}" />
                                            </Frame>
                                        </StackLayout>

                                    </Grid>
                                    
                                </Frame>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </ScrollView>

        </VerticalStackLayout>

    </Grid>

</ContentPage>